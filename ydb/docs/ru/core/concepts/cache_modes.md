# Режимы кэширования {#cache-modes}

Режимы кэширования в {{ ydb-short-name }} позволяют управлять стратегией хранения данных таблиц в оперативной памяти. Это особенно важно для оптимизации времени отклика при чтении небольших часто используемых таблиц. Данный механизм позволяет явно указать:

* какие данные следует предзагружать в память при старте;
* какие данные имеют более высокий приоритет при размещении в кэше;
* какие данные не должны кэшироваться и не влиять на закэшированные данные.

## Доступные режимы

Настройка кэширования задаётся параметром `CACHE_MODE`. Она влияет на то, как будут загружаться и кэшироваться страницы таблиц. Может применяться к группам колонок или к индексам.

Поддерживаются следующие режимы:

| Режим       | Описание |
|-------------|----------|
| `in_memory` | Страницы предзагружаются при старте и вытесняются только после страниц с `CACHE_MODE = normal`. Используется для данных, к которым требуется быстрый доступ. |
| `normal`    | Стандартный режим: страницы загружаются при обращении и вытесняются при достижении лимита памяти. |
| `no_cache`  | Страницы загружаются только в рамках активных транзакций и сразу удаляются из памяти после их завершения. Подходит для редко используемых данных, которые не должны вытеснять данные в кэше. |

## Поведение кэша

При старте данные групп колонок и индексов с режимом  `in_memory` предзагружаются в кэш. Данные групп колонок и индексов с режимом `normal` попадают в кэш при первом обращении. При превышении лимита выделенной памяти сначала вытесняются страницы из `normal`, если этого недостаточно — из `in_memory`. Таким образом, режим `in_memory` предоставляет приоритетное размещение в памяти, но поиводит к её неограниченному потреблению. Данные групп колонок и индексов с режимом `no_cache` загружаются в память только при обращении к ним из активных запросов и транзкций, и выгружаются после их завершения. 

## Использование

Задавать режимы кэширования кэширования можно:

* при [создании таблицы](../yql/reference/syntax/create_table/family.md);
* при [изменении таблицы](../yql/reference/syntax/alter_table/family.md);
* при [изменении индекса](../yql/reference/syntax/alter_table/indexes.md).

## Ограничения и рекомендации

Следует аккуратно комбинировать `in_memory` и `normal` — если данных `in_memory` много и они занимают всю память узла, то все данные `normal` будут вытеснены из кэша вне зависимости от частоты их использования.
